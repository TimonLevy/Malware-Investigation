# CHAPTER 1 - VOLATILITY

This chapter is oriented around learning the memory forensics investigation tool that is Volatility. I will be using the standalone executable version 2.6.

First thing we need to learn is the syntax of the commands and the modules that the tool provides. I will write a single line summary of each modules and some bulletpoints as well:

```
syntax:

volatility.exe -f <memory_file> module_name --profile=<os_profile>
```

#### Modules
```diff
-for every module add what are the parameters it shows/uses
```

**imageinfo** -  Provides info about the operating system and the structure of the memory file.<br>
```diff
+ Parameters:
+ [--profile=PROFILE] Let the module know what profile it should use, if not set will scan for a profile.
+ [--kpcr=ADDRESS] Give the kpcr (Kernel Process Control Region) address instead of letting it scan. This is a pointer to a structure in the kernel that has information about the process like (IDT, GDT and current task).
+ [--kdbg=ADDRESS] Give the kdbg (Kernel DeBuGger) address. This kernel structure houses a lot of properties about the process and changes in memory.
```

**pslist** - Provides a list of the "active" processes at the time of the dump, this will sometimes list inactive processes.<br>
```diff 
+ Parameters:
+ [-p PID/--pid=PID] Supply a pid to show.
+ [-n NAME/--name=NAME] regex check process names and list name matches.
+ [-P] Physical memory offset switch.
```
```diff
- why active in ""? and why will it list inactive processes?
+ Process that are yielding/aren't free cannot remove the EProcess entry from the nt!PsActiveProcessHead trees. And so they are waiting inactive in the tree but don't actually run at the time.
+ Process that are "active" can be differentiated from truly active processes due to the exit time stamp being set and the amount of handle and threads being 0.
- what parameters does it show about each process?
+ PID, PPID, Threads, Handle amount, Sessions, Start time & End time.
```

**pstree** - Prints the output of _pslist_ in a hierarchical structure of parent and child processes.<br>

**psscan** - Prints all structures with the `Proc` kernel pool tag, allowing it to print freed (terminated) or hidden processes as well as the active ones. This searching method can be countered by deleting the tag.<br>
```diff
+ Parameters:
+ [-A START/--start=START] Supply a start address to scan from.
+ [-G LENGTH/--length=LENGTH] The lngth of bytes to scan from the start address.
```

**dlllist** - Prints all the loaded dlls in memory, can print dlls loaded by a specific procees with the `-p`\\`--pid` argument.<br>
```diff
- name the rest of the parameters the command shows
+ The command shows each process and it's DLLs, for each DLL is a Base address, Size, LoadCount and file path.
```

**handles** - Lists all the handles being used by a process or all processes.<br>
```diff
+ You can choose a specific process/es using the [-p/--pid] and [-n/--name] inputs.
+ Silence "less meaningful results" using the [-s] switch.
+ Show a specific file type using [-t OBJECT_TYPE/--object-type=OBJECT_TYPE].
+ [-P offset] Give a physical address offset to scan from.
```
```diff
+ Shows all of the handles with: Offset, PID, Handle, Access, Type, Details (Path). 
```

**cmdscan/consoles** - Both modules show commands typed into cmd on the machine. However consoles has the advantage of showing the output of the commands as well as the command itself.<br>
```diff
+ Parameters:
+ [-m 50 / --max_history=50] The maximum amount of last commands to print, 50 by default.
```

**filescan** - This modules finds file objects in memory using pool tags.<br>
```diff
+ Parameters:
+ [-w] Ignore unallocated memory objects.
+ [-A, -G] Scan specific memory ranges.
```
```diff
+ Outputs Physical memory offset, number of pointers, number of handles, access permissions and Name of each file.
```

**dlldump** - Extracts dlls from the memory file to disk, this modules can dump the DLLS from specific processes. Hidden processes or even DLLs that weres automatically detected dues to malicious activity.<br>
```diff
+ Parameters:
+ [-P, -N] filter processes to extract from.
+ [-D DUMP_DIR] The directory to dump to.
+ [--unsafe] Bypass sanity checks.
+ [--memory] Carve as memory sample and not exe.
+ [--fix] Set the extracted dll base to the in-memory image base.
+ [-r REGEX/--regex=REGEX] Dump only DLLs matching the regex.
+ [--offset=OFFSET] Dump DLLs from the physical offset.
+ [--base=OFFSET] Dump DLLs from the offset to the base address of the process. 
```

**procdump** - This modules can dump a running process' executable file into disk. Use the `-u` flag to bypass sanity checks.<br>
```diff
+ Parameters:
+ [-D]
+ [--memory]
+ [--unsafe]
+ [--fix]
```

**dumpfiles** - Dumps the files that were entered into the VAD (Virtual Address Descriptor) tree. Files may not be stored complete so the dumped files may be "corrupt".<br>
```diff
+ Parameters:
+ [--filter=FILTER] A comma-seperated filter for the files to be dumped.
```

**dumpregistry** - Dumps the all registry hive files it can find, can also dump specific hive files with a `-o` offset argument. Hives may be dumped with some holes which could lead to the crashing of other tools.<br>

**malfind** - Finds injected DLLs\Code segments based on certein charisteristics like unrecognized executables or inconsistent VAD tags. You can export the found segments using the `-D` argument.<br>
```diff
- what exactly is it looking for to say something is suspicious?
+ VADS regions that have the "PAGE_EXECUTE_READWRITE" protection tag, which allows writing and executing the memory region.
+ This usually indicates the the memory was injected and not normally loaded.
```

**hollowfind** - This module's purpose is to find instances of process hollowing, it does this by finding inconsistencies in the VAD or PEB structures.<br>

**psxview** - This modules employs many different ways to enumerate the running processes and compares the findings in columns. This can be used to detect hidden processes that are undetected in some scans but seen in others.<br>
```diff
+ Outputs a list of all indetified processes and and which method of serching found them.
```

**netscan** - Prints a similar output to the `netstat` utility tool. Also uses a similar method to do so. This module prints network artifacts, endpoints and port status.<br>

**apihooks** - This module detecs IAT, EAT and other porms of api hooking using JMP and CALL commands and more.
```diff
+ Ouputs processes and all detecte hooks with:
+ hook types
+ pid + name
+ hook address, module and a snippet of the disassembled code at that address.
```

<br><br><br><br>

♪♬♫<br>
Now here is a story all about how,<br>
Team Matrix was turned right upside down.<br>
And I'd like to tell, just sit right,<br>
Duck Momo was taken hostage by a pregnant women's heir.<br>

In Basis Gidonim, by Matrix bought,<br>
He just sat in the meamen withought any thought.<br>
Chillin out, relaxin, maxin all cool,<br>
and wearning coomta, looking like a fool.<br>

When a pergnant women came and was up to no good,<br>
Started making trouble in the neighborhood.<br>
She took her little infant and Barvazi Momo away,<br>
and we haven't seen him ever since that day.<br>
♪♬♫<br>

```diff
- rhyming 10/10
```
